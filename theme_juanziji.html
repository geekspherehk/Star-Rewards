<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>💪 卷自己 - 个人成长打卡系统</title>
    <link rel="stylesheet" href="style_juanziji.css">
    <!-- Supabase SDK -->
    <script src="supabase.min.js"></script>
    <script>
        console.log('卷自己系统页面开始加载...');
        window.addEventListener('load', function() {
            console.log('卷自己系统页面加载完成');
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>💪 卷自己</h1>
        <div class="subtitle">自律给我自由，坚持就是胜利！</div>
        
        <!-- 用户认证状态卡片 -->
        <div id="auth-status-card" style="margin-bottom: 15px;">
            <!-- 已登录状态 -->
            <div id="logged-in-state" style="display: none; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 12px; border-radius: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 0.9rem; color: #2e7d32; font-weight: 500;">欢迎回来，<span id="user-email"></span></span>
                    <button onclick="signOut()" style="padding: 6px 12px; font-size: 0.8rem; background: #2e7d32; color: white; border: none; border-radius: 12px; cursor: pointer;">退出</button>
                </div>
            </div>
            
            <!-- 未登录状态 -->
            <div id="not-logged-in-state" style="display: none; background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); padding: 12px; border-radius: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 0.9rem; color: #7b1fa2;">开始你的自律之旅吧！</span>
                    <button onclick="window.location.href='login.html'" style="padding: 6px 12px; font-size: 0.8rem; background: #7b1fa2; color: white; border: none; border-radius: 12px; cursor: pointer;">登录</button>
                </div>
            </div>
        </div>
        
        <!-- Tab 导航 -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="points-tab">
                <span class="tab-icon">⚡</span>
                <span class="tab-text">能量值</span>
            </button>
            <button class="tab-btn" data-tab="gifts-tab">
                <span class="tab-icon">🎯</span>
                <span class="tab-text">目标奖励</span>
            </button>
            <button class="tab-btn" data-tab="history-tab">
                <span class="tab-icon">📈</span>
                <span class="tab-text">成长轨迹</span>
            </button>
        </div>

        <!-- 能量值标签页 -->
        <div id="points-tab" class="tab-content active">
            <div class="points-display">
                <div class="points-card energy-card">
                    <div class="points-value" id="current-points">0</div>
                    <div class="points-label">当前能量值</div>
                </div>
                <div class="points-card achievement-card">
                    <div class="points-value" id="total-points">0</div>
                    <div class="points-label">累计成就</div>
                </div>
            </div>
            
            <div class="form-group">
                <h3>⚡ 完成自律任务获得能量</h3>
                <form id="add-behavior-form">
                    <div class="form-row">
                        <input type="text" id="behavior-desc" placeholder="今天完成了什么自律任务？">
                        <input type="number" id="points-change" placeholder="获得能量值（正加负扣）">
                    </div>
                    <div class="preset-behaviors" id="preset-behaviors">
                        <span>快速打卡:</span>
                        <button type="button" class="preset-btn" data-behavior="早起打卡" data-points="10">早起 ⚡10</button>
                        <button type="button" class="preset-btn" data-behavior="运动健身" data-points="15">运动 ⚡15</button>
                        <button type="button" class="preset-btn" data-behavior="阅读学习" data-points="12">学习 ⚡12</button>
                        <button type="button" class="preset-btn" data-behavior="冥想静心" data-points="8">冥想 ⚡8</button>
                        <button type="button" class="preset-btn" data-behavior="健康饮食" data-points="10">健康饮食 ⚡10</button>
                        <button type="button" class="preset-btn" data-behavior="早睡打卡" data-points="8">早睡 ⚡8</button>
                        <button type="button" class="preset-btn" data-behavior="戒手机一小时" data-points="12">专注 ⚡12</button>
                        <button type="button" class="preset-btn" data-behavior="完成重要任务" data-points="20">任务完成 ⚡20</button>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="add-points-btn">⚡ 打卡获得能量</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- 目标奖励标签页 -->
        <div id="gifts-tab" class="tab-content">
            <div class="form-group">
                <h3>🎯 设置自律目标奖励</h3>
                <form id="add-gift-form">
                    <div class="form-row">
                        <input type="text" id="gift-name" placeholder="达成目标后想奖励自己什么？">
                        <input type="number" id="gift-points" placeholder="需要多少能量值？">
                    </div>
                    <div class="form-row">
                        <input type="text" id="gift-description" placeholder="这个奖励有什么特别意义？">
                    </div>
                    <div class="form-row">
                        <input type="text" id="gift-link" placeholder="奖励链接（可选）">
                    </div>
                    <div class="form-row">
                        <input type="text" id="gift-image" placeholder="奖励图片链接（可选）">
                    </div>
                    <div id="image-preview"></div>
                    <button type="submit" class="add-gift-btn">🎯 添加目标奖励</button>
                </form>
            </div>
            
            <h3>🏆 我的目标奖励清单</h3>
            <div class="gift-list-container" id="gift-list"></div>
        </div>

        <!-- 成长轨迹标签页 -->
        <div id="history-tab" class="tab-content">
            <div class="history-container">
                <!-- 自律打卡记录 -->
                <div class="history-section behavior-section">
                    <div class="section-header">
                        <h3>📈 自律打卡记录</h3>
                        <div class="section-badge" id="behavior-count">0</div>
                    </div>
                    <div id="behavior-log"></div>
                </div>
                
                <!-- 目标达成记录 -->
                <div class="history-section redeemed-section">
                    <div class="section-header">
                        <h3>🎉 目标达成记录</h3>
                        <div class="section-badge" id="redeemed-count">0</div>
                    </div>
                    <div id="redeemed-list"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="script_juanziji.js"></script>
</body>
</html>