<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Star Rewards">
    
    <!-- PWA é…ç½® -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    
    <title>Star Rewards - å„¿ç«¥ç§¯åˆ†å¥–åŠ±ç³»ç»Ÿ</title>
    
    <!-- åŸæœ‰CSSæ–‡ä»¶ -->
    <link rel="stylesheet" href="style.css">
    
    <!-- PWA ç§»åŠ¨ç«¯ä¸“ç”¨æ ·å¼ -->
    <link rel="stylesheet" href="pwa-styles.css">
    
    <!-- ç§»åŠ¨ç«¯ä¼˜åŒ–æ ·å¼ -->
    <style>
        /* ç§»åŠ¨ç«¯é€‚é… */
        body {
            -webkit-touch-callout: none;
            -webkit-text-size-adjust: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* é˜²æ­¢è¾“å…¥æ¡†ç¼©æ”¾ */
        input, textarea, select {
            font-size: 16px !important;
        }
        
        /* çŠ¶æ€æ é€‚é… */
        .status-bar-padding {
            padding-top: env(safe-area-inset-top);
        }
        
        /* åº•éƒ¨å®‰å…¨åŒºåŸŸ */
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* è§¦æ‘¸åé¦ˆ */
        .touch-feedback {
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.1s ease;
        }
        
        .touch-feedback:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <!-- åº”ç”¨ä¸»å®¹å™¨ -->
    <div id="app-container">
        <!-- çŠ¶æ€æ å¡«å…… -->
        <div class="status-bar-padding"></div>
        
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <header class="app-header">
            <h1>â­ Star Rewards</h1>
            <div class="user-info">
                <span id="user-email">æœªç™»å½•</span>
                <button id="logout-btn" style="display:none;">é€€å‡º</button>
            </div>
        </header>
        
        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="app-main">
            <!-- ç™»å½•çŠ¶æ€å¡ç‰‡ -->
            <div id="login-status-card" class="card">
                <div id="not-logged-in" class="status-section">
                    <p>è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½</p>
                    <button onclick="window.location.href='login.html'" class="btn-primary">ç«‹å³ç™»å½•</button>
                </div>
                <div id="logged-in" class="status-section" style="display:none;">
                    <div class="points-display">
                        <div class="current-points">
                            <span class="points-label">å½“å‰ç§¯åˆ†</span>
                            <span id="current-points-value" class="points-value">0</span>
                        </div>
                        <div class="total-points">
                            <span class="points-label">ç´¯è®¡ç§¯åˆ†</span>
                            <span id="total-points-value" class="points-value">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åŠŸèƒ½æ¨¡å—å¯¼èˆª -->
            <nav class="module-nav">
                <button class="module-btn active" data-module="points">
                    <span class="icon">â­</span>
                    <span>æˆé•¿ç§¯åˆ†</span>
                </button>
                <button class="module-btn" data-module="wishes">
                    <span class="icon">ğŸ</span>
                    <span>å®è´æ„¿æœ›</span>
                </button>
                <button class="module-btn" data-module="diary">
                    <span class="icon">ğŸ“–</span>
                    <span>æˆé•¿æ—¥è®°</span>
                </button>
            </nav>
            
            <!-- åŠŸèƒ½æ¨¡å—å†…å®¹ -->
            <div class="module-content">
                <!-- æˆé•¿ç§¯åˆ†æ¨¡å— -->
                <div id="points-module" class="module active">
                    <div class="section">
                        <h3>è®°å½•æ–°è¡Œä¸º</h3>
                        <div class="form-group">
                            <input type="text" id="behavior-input" placeholder="æè¿°å­©å­çš„å¥½è¡Œä¸º..." class="form-input">
                            <input type="number" id="points-input" placeholder="ç§¯åˆ†" class="form-input" min="1" max="100">
                            <button onclick="addBehavior()" class="btn-primary">æ·»åŠ è®°å½•</button>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>æœ€è¿‘è®°å½•</h3>
                        <div id="behavior-log" class="behavior-log">
                            <p>æš‚æ— è®°å½•</p>
                        </div>
                    </div>
                </div>
                
                <!-- å®è´æ„¿æœ›æ¨¡å— -->
                <div id="wishes-module" class="module">
                    <div class="section">
                        <h3>æ·»åŠ æ„¿æœ›ç¤¼ç‰©</h3>
                        <div class="form-group">
                            <input type="text" id="gift-name-input" placeholder="ç¤¼ç‰©åç§°" class="form-input">
                            <input type="number" id="gift-points-input" placeholder="æ‰€éœ€ç§¯åˆ†" class="form-input" min="1">
                            <input type="url" id="gift-link-input" placeholder="å•†å“é“¾æ¥ï¼ˆå¯é€‰ï¼‰" class="form-input">
                            <textarea id="gift-description-input" placeholder="ç¤¼ç‰©æè¿°" class="form-input" rows="3"></textarea>
                            <button onclick="addGift()" class="btn-primary">æ·»åŠ æ„¿æœ›</button>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>æ„¿æœ›æ¸…å•</h3>
                        <div id="gift-list" class="gift-list">
                            <p>æš‚æ— æ„¿æœ›</p>
                        </div>
                    </div>
                </div>
                
                <!-- æˆé•¿æ—¥è®°æ¨¡å— -->
                <div id="diary-module" class="module">
                    <div class="section">
                        <h3>æˆé•¿è®°å½•</h3>
                        <div id="diary-list" class="diary-list">
                            <p>æš‚æ— è®°å½•</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
        <div class="safe-area-bottom"></div>
    </div>
    
    <!-- PWA å®‰è£…æŒ‰é’® -->
    <button id="installButton" style="display:none;">å®‰è£…åº”ç”¨</button>
    
    <!-- PWA ç®¡ç†å™¨ -->
    <script type="module" src="pwa-manager.js"></script>
    
    <!-- ç§»åŠ¨ç«¯åº”ç”¨è„šæœ¬ -->
    <script src="mobile-app.js"></script>
    
    <!-- Supabase è„šæœ¬ -->
    <script type="module" src="supabase.min.js"></script>
</body>
</html>